<h1>Вебсокеты на ActixWeb</h1>

<h3>Быстрый запуск</h3>

<p>Команда для быстрого запуска: <code>cargo run</code></p>

<p>
    Проект будет развернут локально и доступен по пути: <code>ws://127.0.0.1:8080/api/v1/</code>
</p>

<p>Проверка функционала производилась посредством <b>Postman</b> и модульных тестов.</p>

<h2>Команды</h2>

<ul>
    <li>
        Добавление: 
        <code>{"action": "add_book", "book": {"title": "Test Book", "author": "I am", "year": 2024}}</code>
    </li>
    <li>
        Получение всех: <code>{"action": "get_books"}</code>
    </li>
    <li>
        Получение по идентификатору: <code>{"action": "get_book", "id": "123456"}</code>
    </li>
    <li>
        Обновление: 
        <code>{"action": "update_book", "id": "123456", "book": {"title": "Test Book 2", "author": "You are", "year": 2024}}</code>
    </li>
    <li>
        Удаление: 
        <code>{"action": "delete_book", "id": "123456"}</code>
    </li>
</ul>

<h2>Внутреннее устройство</h2>

<h3>Корень проекта</h3>

<p>
    Корнем проекта является файл <b>main.rs</b> 
    и функция <code>main</code>.
</p>

<p>
    Здесь происходит инициализация серверного приложения и минимальное заполнение репозитория.
</p>

<h3>Роутер/Контроллер</h3>

<p>Роутинг и контроль различных команд происходит в файле <b>controller.rs</b></p>

<p>
    Управление соединениями происходит посредством функции: <code>route</code>
    <br>
    Тут же, посредством макроса, объявляется базовый путь: <code>/api/v1/</code>
</p>

<p>
    Функция <code>do_action</code> производит контроль над типами запросов (экшенов), посредством сопоставления с вариантами перечисления: <code>ActionTypes</code>
</p>

<p>
Также здесь присутствуют следующие вспомогательные методы: <code>serialize</code> и <code>send_response</code>, отвечающие за сериализацию структур для ответа, и отправку ответа по сокету, сответственно.
</p>

<h3>Репозиторий и хранение данных</h3>

<p>Структура для работы с данными, реализована в файле <b>repository.rs</b></p>

<p>
    В вышеуказанном файле, присутствует реализация структуры <code>BookRepository</code> посредством типажа <code>Repository</code>.
    <br>
    Типаж и его реализация для структуры позволяют использовать минимально необходимые методы <b>CRUD</b>. 
</p>


<h3>Определение формата данных</h3>

<p>
    Формат данных предметной области описан в файле <b>entity.rs</b> и предствален, сериализуемой структурой <code>Book</code>.
</p>

<h3>Обработка ошибок</h3>

<p>
    Сериализуемая структура стандартных ошибок реализована в модуле <code>error</code>, файл <b>error.rs</b>
</p>

<p>
    Стандартные коды ошибок (400, 404, 500) объявлены в модуле <code>code</code>, файле <b>error/code.rs</b>
</p>

<h3>Тестирование</h3>

<p>
    Тестирование производится посредством команды <code>cargo test</code>
</p>

<p>
    Модуль тестирования и функции реализованы в файле <b>main.rs</b>
</p>
